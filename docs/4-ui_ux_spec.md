# CoreTerra Web端UI/UX设计规范

## 引言：设计原则

本设计规范旨在为CoreTerra Web应用提供一套清晰、一致且高效的UI/UX框架。我们的核心设计哲学——“文本即棋盘” (Text as the Game Board)——是将复杂的后端工作流简化为用户直观的文本编辑体验。Architectural Rationale: 这一理念确保了用户的每一次重要操作都能生成一个版本可控、可审计的数据构件，为系统的AI就绪性和未来的流程挖掘奠定了不可变的数据基础。

此理念借鉴了“智能终端”和“CLI + Note”的融合隐喻，将强大的功能封装在极简的界面之下，旨在为非技术用户提供一个既友好又高效的工作环境。我们相信，通过将每一个任务、每一次状态变更都视为对结构化文本的一次操作，可以极大地降低认知负荷，让用户专注于内容本身，而非界面操作。

为此，本规范确立了三个核心设计目标：

* 极致简化 (Minimalism): 界面设计将剥离所有非必要的装饰性元素。我们的目标是借鉴Notion为个人工作流带来的灵活性，但通过MyST强制实现结构一致性，以确保数据对于未来的AI分析是机器可读的。
* 高效交互 (Efficiency): 所有核心操作均以键盘优先为原则。通过全局命令面板（Command Palette）等设计，确保高频操作能够被快速、直接地调用，从而满足高级用户的效率需求。
* 用户友好 (User-Friendliness): 尽管设计思想借鉴了IDE（集成开发环境），但最终产品必须对非技术人员友好。我们将通过清晰的视觉层次和直观的交互模式，显著降低用户的学习成本和上手门槛。

接下来，我们将从应用的整体布局开始，逐步深入探讨构成CoreTerra体验的核心组件与交互模式。

---

## 1. 整体布局设计 (Overall Layout Design)

CoreTerra采用经典的三栏式布局，这一结构经过了深思熟虑，旨在为用户提供一个清晰、有序且专注的工作环境。Architectural Rationale: 这种布局通过将导航、核心工作区和上下文辅助信息进行物理分离，实现了清晰的关注点分离（Separation of Concerns），不仅帮助用户在宏观概览和微观操作之间无缝切换，同时也为未来功能的模块化扩展提供了稳定的结构基础。

三栏结构定义

功能 (Function)	内容 (Content)	行为 (Behavior)
左侧栏 (Left Panel): 角色与导航区	作为项目或角色的主要导航入口，承载着应用的信息架构。	包含可折叠的角色列表、团队空间或项目视图切换器。
中间栏 (Center Panel): 编辑器与列表核心工作区	用户进行查看、编辑和交互的主要区域，是所有工作的核心发生地。	动态显示TaskListView（任务列表）或TaskDetailView（任务详情）。
右侧栏 (Right Panel): AI控制台与团队状态区	上下文相关的辅助工具集合区，提供即时信息和智能支持。	包含AI助手控制台、团队成员在线状态、最近活动流或当前任务的详细元数据。

在定义了应用的宏观布局之后，我们将深入探讨构成核心工作区的关键组件，这些组件是"文本即棋盘"理念的具体体现。

---

## 2. 核心组件规范 (Core Component Specification)

TaskListView和TaskDetailView是CoreTerra应用的核心，它们协同工作，构成了“文本即棋盘”理念的实践基础。这两个组件为用户提供了从宏观任务概览到微观任务编辑的无缝工作流，确保了信息的一致性和操作的连贯性。

2.1 任务列表视图 (TaskListView)

TaskListView是项目的核心仪表盘，其设计目标是信息的高度可扫描性、导航的便捷性以及过滤的强大性。我们借鉴了Notion、Asana和Jira等业界领先工具的最佳实践，以确保用户能够快速定位和处理关键信息。

* 清晰的视觉层次 (Clear Hierarchy): 列表中的每一行都必须建立明确的信息层级。任务标题应最为突出，元数据（如负责人、截止日期）则以次级视觉元素呈现，确保用户能一目了然地捕捉核心内容。
* 可排序的列 (Sortable Columns): 所有关键元数据列（如优先级、截止日期、创建时间）必须支持点击排序。这赋予用户按需组织视图的能力，以适应不同的工作情境。
* 状态与元数据标签 (Status & Metadata Tags): 任务状态与优先级等关键信息应使用颜色编码的标签。与Asana类似，我们将使用视觉进度指示器和颜色编码标签来简化沟通。
* 强大的过滤功能 (Powerful Filtering): 用户必须能够基于状态、标签、负责人等多个维度轻松过滤列表。与Jira一样，我们强大的过滤器将简化复杂待办事项列表的管理。
* 可定制视图 (Customizable Views): 借鉴Notion的灵活性，用户应能根据个人工作流的需求，自定义显示的列。这种个性化能力使用户可以将视图调整为最适合其工作流程的形态。

2.2 任务详情视图 (TaskDetailView)

TaskDetailView是单个任务的“源文件”编辑器，是所有具体工作的发生地。它不仅是信息的展示器，更是一个可交互的、动态更新的工作界面。

* 强制集成MyST渲染: 此视图 必须 集成一个MyST Markdown渲染库。Architectural Rationale: 这一选择是经过深思熟虑的；通过在MyST及其YAML frontmatter上进行标准化，我们创建了结构化的、机器可读的元数据，这对于未来的AI摄取管道至关重要，并确保每个任务都是一个可审计的、自包含的文档。
* 内容结构:
  * YAML Frontmatter区域: 任务的所有结构化元数据，如 id, status, priority, tags, due_date 等，都存储在文件顶部的YAML frontmatter中。在UI中，该区域应以清晰、可编辑的表单字段或标签组的形式展示，确保元数据管理的直观性。
  * Markdown Body区域: 任务的详细描述、笔记、上下文和子任务清单则存在于Markdown正文中，为自由格式的内容创作提供最大灵活性。
* 核心交互要求: 渲染后的Markdown内容必须是可交互的。这意味着UI操作必须能直接反映到底层的文本文件中。例如：
  * 交互式复选框 (Interactive Checkbox): 当用户在渲染后的UI中点击一个Markdown复选框（从未选中[ ]变为选中[x]）时，应用必须能够实时更新底层MyST文件的文本内容，并同步触发一次后端的原子性状态变更。这种UI渲染层与底层源文件之间的双向数据绑定，是“文本即棋盘”哲学的核心机制。它确保了每一次GUI交互都是对版本控制的真实源的一次原子性的、可审计的修改。

通过将UI操作与底层文件系统和版本控制深度绑定，我们确保了每一次交互都既直观又可追溯，为后续的复杂操作和AI分析奠定了坚实基础。

---

## 3. 关键交互模式 (Key Interaction Models)

CoreTerra的核心交互模式在于，将用户的每一次重要GUI操作都封装成一次原子性的、可审计的Git提交。Architectural Rationale: 这种设计不仅确保了数据的完整性和版本历史的不可变性，更为未来AI分析提供了精确、可靠的事件日志，真正做到了每一次操作都有据可查。

核心工作流：完成一个任务

以下场景详细分解了当用户在TaskDetailView中点击“完成”按钮时，系统内部的完整流程：

1. 前端触发 (Frontend Trigger) 用户在TaskDetailView界面上点击“完成”按钮，或勾选代表任务完成的复选框。
2. API请求 (API Request) React前端立即向FastAPI后端发送一个PUT请求。例如，PUT /tasks/{task_id}/status，请求体中包含新的状态信息：{"status": "completed"}。
3. 后端处理 (Backend Processing)
  * FastAPI后端接收到请求，并根据task_id定位到对应的MyST Markdown文件。
  * 后端服务解析该文件，并精确地更新其YAML frontmatter，将status字段的值修改为completed。
  * 随后，后端调用Python的Git库，在文件系统层面执行git add和git commit操作，将此次变更固化到版本历史中。
4. 架构实现说明： 由于文件I/O和Git命令是阻塞操作，为防止它们长时间占用并阻塞异步事件循环，处理此请求的FastAPI端点必须定义为同步函数 (def 而非 async def)。这将指示FastAPI在内部线程池中执行该操作，从而保持主事件循环的响应性。
5. 标准化Git Commit (Standardized Git Commit) 生成的Git提交信息必须遵循严格的、机器可读的标准化格式。例如：COMPLETE: Task 'COT-123' marked as completed by user 'user_id'. 这种做法将Git日志从简单的版本历史转变为一个结构化的、不可变的事件日志，无需单独的事件溯源系统即可用于高级流程挖掘和性能分析。
6. 索引更新 (Index Update) 在Git提交成功后，后端同步更新SQLite元数据索引库。这一步至关重要，它确保了TaskListView等需要高性能查询的视图能够快速、准确地反映最新状态，而无需遍历整个文件系统。

这一系列操作——文件写入、Git提交、数据库索引更新——被设计为一个原子事务。这种模式保证了系统状态的一致性：要么所有步骤全部成功，要么全部回滚，从而杜绝了数据不一致的风险。这种交互模式的优点在于其鲁棒性和可追溯性，接下来我们将探讨如何在界面上以非侵入式的方式反馈这些操作带来的结果。

---

## 4. 游戏化反馈系统 (Gamification Feedback System)

CoreTerra的游戏化反馈系统遵循两大指导原则：非侵入式 (Non-intrusive) 和 内联 (Inline)。我们的目标是提供微妙的、与上下文紧密结合的激励，而非通过干扰性的弹窗或动画打断用户的“心流”状态。所有反馈元素都应无缝集成于工作流之中，成为信息的自然延伸。

反馈元素与UI呈现方式

元素 (Element)	描述 (Description)	UI呈现方式 (UI Representation)
XP (Experience Points)	代表用户完成任务或达成特定目标时获得的经验值，是即时成就感的体现。	在任务完成后短暂以内联标签形式出现（如 +10 XP），随后淡出或整合进任务元数据中，避免造成永久性的视觉混乱。
Gems (Gems)	一种稀有奖励，可用于兑换虚拟物品或解锁特殊功能，用于长期激励。	在状态栏或用户个人资料区域以一个小的宝石图标和数字显示。避免在任务界面本身上造成视觉干扰，保持工作区的纯净。
PQI / CAR 指标	核心绩效指标，用于衡量产出质量和贡献度，是面向团队和管理者的分析工具。	在右侧栏的团队状态面板或个人统计仪表盘中，以图表或数值形式集中展示。这些宏观指标不应与单个任务的即时反馈混淆。
成就徽章 (Badges)	当用户达成特定里程碑（如“完成100个任务”）后获得的象征性奖励，用于记录长期成就。	主要显示在用户的个人资料页。当获得新徽章时，在主导航栏或状态栏的个人头像旁出现一个不打断操作的微小通知图标，引导用户查看。

设计禁区

为了维护应用的专业性和专注度，以下设计模式被严格禁止：

* 禁止使用模态弹窗或覆盖层来宣布奖励或成就。
* 禁止使用华丽、长时间的动画效果来分散用户对核心工作的注意力。
* 禁止默认使用声音通知，所有音频反馈必须由用户主动开启。

通过这种内联、克制的反馈系统，我们确保了游戏化元素能够与应用的极简设计哲学和谐共存，共同创造一个既能有效激励用户、又能保持高度专业性的高效工作环境。
